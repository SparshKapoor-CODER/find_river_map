<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>River Map Explorer üåç</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- External CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="page-shell">
    <div class="card">
      <header class="header">
        <div>
          <h1>River Map Explorer üåä</h1>
          <p class="subtitle">
            Generate high-quality river maps for any supported country using GeoPandas & HydroRivers.
          </p>
        </div>
      </header>

      <!-- Flash messages -->
      {% with messages = get_flashed_messages() %}
        {% if messages %}
          {% for msg in messages %}
            <div class="message message-error">
              {{ msg }}
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <!-- Country dropdown form -->
      <form id="country-form" action="{{ url_for('generate') }}" method="post" class="form">
        <label for="country-select" class="field-label">Country</label>
        <div class="field-row">
          <select id="country-select" name="country" required>
            <option value="" disabled {% if not country %}selected{% endif %}>Select a country‚Ä¶</option>
            {% for c in countries %}
              <option value="{{ c }}" {% if country == c %}selected{% endif %}>
                {{ c }}
              </option>
            {% endfor %}
          </select>

          <button type="submit" id="generate-btn">
            Generate Map
          </button>
        </div>

        <p class="hint">
          Only the countries listed in the dropdown are supported. Choose one and click <b>Generate Map</b>.
        </p>
      </form>

      <!-- Map + download section -->
      {% if map_png %}
        <section class="map-section">
          <div class="map-header">
            <div class="map-title">
              Showing rivers of <strong>{{ country }}</strong>
            </div>
            <div class="map-actions">
              <a href="{{ url_for('download_png', filename=map_png) }}" class="btn-link">
                <button type="button" class="btn-secondary">Download PNG</button>
              </a>
              {% if map_pdf %}
                <a href="{{ url_for('download_pdf', filename=map_pdf) }}" class="btn-link">
                  <button type="button" class="btn-secondary">Download PDF</button>
                </a>
              {% endif %}
            </div>
          </div>

          <div class="map-wrapper">
            <img
              src="{{ url_for('output_file', filename=map_png) }}"
              alt="River map of {{ country }}"
            >
          </div>

          <p class="map-footnote">
            Tip: Use the PDF version for printing or zooming deeply without losing quality.
          </p>
        </section>
      {% else %}
        <section class="empty-state">
          <div class="empty-icon">üó∫Ô∏è</div>
          <div class="empty-text-main">No map yet</div>
          <div class="empty-text-sub">
            Pick a country from the dropdown above and click <strong>Generate Map</strong> to visualize its rivers.
          </div>
        </section>
      {% endif %}
    </div>
  </div>

  <!-- External JS -->
  <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
